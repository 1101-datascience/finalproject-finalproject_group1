<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        Group1. 以股為鏡–台股上漲預測 - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@hackmd/emojify.js@2.1.0/dist/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @import url(https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i|Source+Code+Pro:300,400,500|Source+Sans+Pro:300,300i,400,400i,600,600i|Source+Serif+Pro&subset=latin-ext);.hljs{display:block;background:#fff;padding:.5em;color:#333;overflow-x:auto}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-string,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#a71d5d}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#0086b3}.hljs-built_in,.hljs-builtin-name{color:#005cc5}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#795da3}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.markdown-body{font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{font-size:16px;padding:0 1em;color:#777;border-left:.25em solid #ddd}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body kbd,.popover kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid #ccc;border-bottom-color:#bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{padding-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:0;padding-top:.2em;padding-bottom:.2em;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\00a0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0 none}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important;position:relative}.markdown-body .emoji{vertical-align:top}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p:last-child{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram,.markdown-body pre.vega{text-align:center;background-color:inherit;border-radius:0;white-space:inherit;overflow:visible}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code,.markdown-body pre.vega>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg,.markdown-body pre.vega>svg{max-width:100%;height:100%}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p:last-child,.markdown-body .alert>ul:last-child{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body .mark,.markdown-body mark{background-color:#fff1a7}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.figma{display:table;position:relative;width:100%;padding-bottom:56.25%}.figma iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%;border:1px solid #eee}.MJX_Assistive_MathML{display:none}#MathJax_Message{z-index:1000!important}.ui-infobar{position:relative;z-index:2;max-width:760px;margin:25px auto -25px;color:#777}.toc .invisable-node{list-style-type:none}.ui-toc{position:fixed;bottom:20px;z-index:998}.ui-toc.both-mode{margin-left:8px}.ui-toc.both-mode .ui-toc-label{height:40px;padding:10px 4px;border-top-left-radius:0;border-bottom-left-radius:0}.ui-toc-label{background-color:#e6e6e6;border:none;color:#868686;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#fff;transition:opacity .2s}.ui-toc-label:focus{opacity:.3;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;transition:opacity .2s}.ui-toc-dropdown{margin-top:20px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child>ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,sans-serif}html[lang^=ja] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}html .markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html .markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html .markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}html[lang^=ja] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}html[lang=zh-tw] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html[lang=zh-cn] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}html .ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}html .ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html .ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:#999}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:50%;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:cover}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}.ui-infobar>small>span{line-height:22px}.ui-infobar>small .dropdown{display:inline-block}.ui-infobar>small .dropdown a:focus,.ui-infobar>small .dropdown a:hover{text-decoration:none}.ui-more-info{color:#888;cursor:pointer;vertical-align:middle}.ui-more-info .fa{font-size:16px}.ui-connectedGithub,.ui-published-note{color:#888}.ui-connectedGithub{line-height:23px;white-space:nowrap}.ui-connectedGithub a.file-path{color:#888;text-decoration:none;padding-left:22px}.ui-connectedGithub a.file-path:active,.ui-connectedGithub a.file-path:hover{color:#888;text-decoration:underline}.ui-connectedGithub .fa{font-size:20px}.ui-published-note .fa{font-size:20px;vertical-align:top}.unselectable{-webkit-user-select:none;-o-user-select:none;user-select:none}.selectable{-webkit-user-select:text;-o-user-select:text;user-select:text}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}.site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,sans-serif}html[lang^=ja] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;letter-spacing:.025em;font-family:Source Sans Pro,Helvetica,Arial,sans-serif}html[lang^=ja] body{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}abbr[data-original-title],abbr[title]{cursor:help}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid comment-enabled" data-hard-breaks="true"><p><span class="toc"><ul>
<li><a href="#Group1-以股為鏡–台股上漲預測" title="Group1. 以股為鏡–台股上漲預測">Group1. 以股為鏡–台股上漲預測</a><ul>
<li class="invisable-node"><ul>
<li><a href="#Menbers" title="Menbers">Menbers</a></li>
<li><a href="#Our-Goal" title="Our Goal">Our Goal</a></li>
<li><a href="#Demo" title="Demo">Demo</a></li>
</ul>
</li>
<li><a href="#Folder-organization-and-its-related-information" title="Folder organization and its related information">Folder organization and its related information</a><ul>
<li><a href="#docs" title="docs">docs</a></li>
<li><a href="#data" title="data">data</a></li>
<li><a href="#code" title="code">code</a></li>
<li><a href="#results" title="results">results</a></li>
<li><a href="#Future-Work" title="Future Work">Future Work</a></li>
</ul>
</li>
<li><a href="#Model" title="Model">Model</a><ul>
<li><a href="#Logistic-Regression" title="Logistic Regression">Logistic Regression</a></li>
<li><a href="#QDA" title="QDA">QDA</a></li>
<li><a href="#NaiveBayes" title="NaiveBayes">NaiveBayes</a></li>
<li><a href="#Decision-Tree" title="Decision Tree">Decision Tree</a></li>
<li><a href="#Random-Forest" title="Random Forest">Random Forest</a></li>
<li><a href="#SVM" title="SVM">SVM</a></li>
<li><a href="#CNN-amp-TCN" title="CNN &amp; TCN">CNN &amp; TCN</a></li>
<li><a href="#LSTM" title="LSTM">LSTM</a></li>
</ul>
</li>
<li><a href="#References" title="References">References</a><ul>
<li><a href="#Packages-you-use" title="Packages you use">Packages you use</a></li>
<li><a href="#Related-publications" title="Related publications">Related publications</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</span></p><h1 id="Group1-以股為鏡–台股上漲預測" data-id="Group1-以股為鏡–台股上漲預測"><a class="anchor hidden-xs" href="#Group1-以股為鏡–台股上漲預測" title="Group1-以股為鏡–台股上漲預測"><span class="octicon octicon-link"></span></a><span>Group1. 以股為鏡–台股上漲預測</span></h1><h3 id="Menbers" data-id="Menbers"><a class="anchor hidden-xs" href="#Menbers" title="Menbers"><span class="octicon octicon-link"></span></a><span>Menbers</span></h3><table>
<thead>
<tr>
<th><span>Name</span></th>
<th><span>Dep.</span></th>
<th><span>StudentID</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>趙啟宏</span></td>
<td><span>統計三</span></td>
<td><span>108304010</span></td>
</tr>
<tr>
<td><span>謝政彥</span></td>
<td><span>資科碩二</span></td>
<td><span>109753207</span></td>
</tr>
<tr>
<td><span>張皓博</span></td>
<td><span>資科碩一</span></td>
<td><span>110753113</span></td>
</tr>
<tr>
<td><span>鄭詠儒</span></td>
<td><span>資科碩一</span></td>
<td><span>110753126</span></td>
</tr>
<tr>
<td><span>林依樺</span></td>
<td><span>資科碩一</span></td>
<td><span>110753207</span></td>
</tr>
</tbody>
</table><h3 id="Our-Goal" data-id="Our-Goal"><a class="anchor hidden-xs" href="#Our-Goal" title="Our-Goal"><span class="octicon octicon-link"></span></a><span>Our Goal</span></h3><p><span>以美股四大指數和比特幣匯率等變數預測台股上市指數加權的漲或跌。(假設每天的股價沒有關聯)</span></p><h3 id="Demo" data-id="Demo"><a class="anchor hidden-xs" href="#Demo" title="Demo"><span class="octicon octicon-link"></span></a><span>Demo</span></h3><p><span>You should provide an example commend to reproduce your result</span></p><ul>
<li><span>使用G1_DecisionTree.R，採以下指令執行</span></li>
</ul><pre><code class="R hljs">Rscript code/G1_DecisionTree.R --input data/ourdata.csv --output results/G1_Decision_tree.csv
</code></pre><p><span>Running this script will output 1 csv file(G1_Decision_tree.csv) and 1 pdf file(Rplots).</span></p><h4 id="on-line-visualization" data-id="on-line-visualization"><a class="anchor hidden-xs" href="#on-line-visualization" title="on-line-visualization"><span class="octicon octicon-link"></span></a><span style="color:#ff595e"><strong><span>on-line visualization</span></strong></span></h4><p><span>Shiny:</span><a href="https://yungrujeng.shinyapps.io/finalproject-finalproject_group1" target="_blank" rel="noopener"><span>https://yungrujeng.shinyapps.io/finalproject-finalproject_group1</span></a></p><h2 id="Folder-organization-and-its-related-information" data-id="Folder-organization-and-its-related-information"><a class="anchor hidden-xs" href="#Folder-organization-and-its-related-information" title="Folder-organization-and-its-related-information"><span class="octicon octicon-link"></span></a><span>Folder organization and its related information</span></h2><h3 id="docs" data-id="docs"><a class="anchor hidden-xs" href="#docs" title="docs"><span class="octicon octicon-link"></span></a><span>docs</span></h3><ul>
<li>
<p><span>our presentation: </span><a href="https://docs.google.com/presentation/d/1IE9MhMOmIkNQ0jkG6rfE23GG3aa0-ba_AdzETKb8PmM/edit#slide=id.g10acf957bb0_0_40" target="_blank" rel="noopener"><span>DS_FinalProject_G1.pptx</span></a></p>
</li>
<li>
<p><span>related document for the final project</span></p>
<ul>
<li><span>final paper</span></li>
</ul>
</li>
</ul><h3 id="data" data-id="data"><a class="anchor hidden-xs" href="#data" title="data"><span class="octicon octicon-link"></span></a><span>data</span></h3><ul>
<li><span>Source</span><br>
<span>*</span></li>
<li><span>Any preprocessing?</span>
<ul>
<li><code>our_data.csv</code><span>將各指標轉為第(t-1)天的數值，以及第t天整體是否漲跌的lable。</span></li>
<li><span>Creating new features:</span>
<ul>
<li><code>only_diff.csv</code><span>:將指數轉換成漲跌幅百分比，並保留百分比捨棄原始資料。</span>
<ul>
<li><span>可以使用perporcessing.R進行生成。</span></li>
</ul>
</li>
<li><code>ourdata_addFeatures5.csv</code><span>:保留原始第t-1天的數值資料，並增加特徵。</span></li>
</ul>
</li>
<li><span>資料標準化:Scale value、min-max</span></li>
<li><span>Split datqa into Training Set,Valiidation Set,Test Set.</span><br>
<img src="https://i.imgur.com/VjX0L3J.png" alt="" loading="lazy"><br>
<span>Describe every features in the final paper.</span></li>
</ul>
</li>
</ul><h3 id="code" data-id="code"><a class="anchor hidden-xs" href="#code" title="code"><span class="octicon octicon-link"></span></a><span>code</span></h3><ul>
<li><span>Which method do you use?</span>
<ul>
<li><span>Decision Tree</span></li>
<li><span>RandomForest</span></li>
<li><span>Support Vector Machine</span></li>
<li><span>Naice Bayes</span></li>
<li><span>Logistic Regression</span></li>
<li><span>Quadratic Discriminant Analysis</span></li>
<li><span>CNN &amp; TNN</span></li>
</ul>
</li>
<li><span>What is a null model for comparison?</span>
<ul>
<li><span>Random Binomial Distribution</span></li>
</ul>
</li>
<li><span>evaluation</span>
<ul>
<li><span>Method:5-fold cross validation</span></li>
</ul>
</li>
</ul><h3 id="results" data-id="results"><a class="anchor hidden-xs" href="#results" title="results"><span class="octicon octicon-link"></span></a><span>results</span></h3><ul>
<li><span>Which metric do you use</span>
<ul>
<li><span>Precision</span></li>
<li><span>Accuracy</span></li>
<li><span>Recall</span></li>
<li><span>R-square</span></li>
<li><span>Area under curve</span></li>
<li><span>ROC Curve</span><br>
<span style="color:red"><strong><span>result/G1_Modelname.csv</span></strong></span><br>
<span style="color:red"><strong><span>image/G1_Modelname(AUC).jpg (AUC)</span></strong></span></li>
</ul>
</li>
<li><span>Is your improvement significant?</span><br>
<span>A little bit, but not for all kinds of models</span></li>
<li><span>What is the challenge part of your project?</span><br>
<span>1.Data is not enough</span><br>
<span>2.Don’t how to deal with time series</span><br>
<span>3.Aren’t that familiar with financial data</span></li>
</ul><h3 id="Future-Work" data-id="Future-Work"><a class="anchor hidden-xs" href="#Future-Work" title="Future-Work"><span class="octicon octicon-link"></span></a><span>Future Work</span></h3><p><span>1.Increase the amount of data</span><br>
<span>2.Learn how to manage time series</span><br>
<span>3.Watch more financial news in daily life</span></p><h2 id="Model" data-id="Model"><a class="anchor hidden-xs" href="#Model" title="Model"><span class="octicon octicon-link"></span></a><span>Model</span></h2><h3 id="Logistic-Regression" data-id="Logistic-Regression"><a class="anchor hidden-xs" href="#Logistic-Regression" title="Logistic-Regression"><span class="octicon octicon-link"></span></a><span>Logistic Regression</span></h3><h4 id="import" data-id="import"><a class="anchor hidden-xs" href="#import" title="import"><span class="octicon octicon-link"></span></a><span>import</span></h4><pre><code class="R hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span>
<span></span>
<span></span></div><div class="code"><span class="hljs-function"><span class="hljs-title">library</span><span class="hljs-params">(caret)</span></span>
<span class="hljs-function"><span class="hljs-title">library</span><span class="hljs-params">(e1071)</span></span>
<span class="hljs-function"><span class="hljs-title">library</span><span class="hljs-params">(data.table)</span></span>
<span class="hljs-function"><span class="hljs-title">library</span><span class="hljs-params">(tidyr)</span></span>
<span class="hljs-function"><span class="hljs-title">library</span><span class="hljs-params">(pROC)</span></span>
</div></div></code></pre><h4 id="Data-pre-processing" data-id="Data-pre-processing"><a class="anchor hidden-xs" href="#Data-pre-processing" title="Data-pre-processing"><span class="octicon octicon-link"></span></a><span>Data pre-processing</span></h4><div class="alert alert-info">
<p><span>對data做scale正規化</span></p>
</div><h4 id="Model-參數" data-id="Model-參數"><a class="anchor hidden-xs" href="#Model-參數" title="Model-參數"><span class="octicon octicon-link"></span></a><span>Model 參數</span></h4><pre><code class="R hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span></div><div class="code"><span class="hljs-title">model_reg</span> &lt;- glm(formula = <span class="hljs-type">TAIEX</span> ~ ., 
                <span class="hljs-class"><span class="hljs-keyword">data</span>=train_data, </span>
                <span class="hljs-keyword">family</span>=binomial(link=<span class="hljs-string">"logit"</span>))
</div></div></code></pre><h4 id="Rscript-command" data-id="Rscript-command"><a class="anchor hidden-xs" href="#Rscript-command" title="Rscript-command"><span class="octicon octicon-link"></span></a><span>Rscript command</span></h4><ul>
<li><span>使用</span><code>G1_LogisticRegression.R</code><span>，按照以下方式執行:</span></li>
</ul><pre><code class="R hljs">Rscript G1_LogisticRegression<span class="hljs-selector-class">.R</span> <span class="hljs-attr">--fold</span> <span class="hljs-number">5</span> <span class="hljs-attr">--input</span> <span class="hljs-selector-attr">[dataset_path]</span>  <span class="hljs-attr">--report</span> <span class="hljs-selector-attr">[report_path]</span>
</code></pre><h4 id="步驟" data-id="步驟"><a class="anchor hidden-xs" href="#步驟" title="步驟"><span class="octicon octicon-link"></span></a><span>步驟</span></h4><ul>
<li><span>Step1: 將資料最後100筆切為test data</span></li>
<li><span>Step2: 剩下的train data 拿去訓練以及5-fold cross validation(train/validation比例0.8: 0.2)</span></li>
<li><span>Step3: cross validation 結果</span></li>
</ul><table>
<thead>
<tr>
<th style="text-align:left"><span>GlmModel</span></th>
<th style="text-align:left"><span>train_auc</span></th>
<th style="text-align:left"><span>valid_auc</span></th>
<th style="text-align:left"><span>train_ac</span></th>
<th style="text-align:left"><span>valid_ac</span></th>
<th style="text-align:left"><span>train_precision</span></th>
<th style="text-align:left"><span>valid_precision</span></th>
<th style="text-align:left"><span>train_recall</span></th>
<th style="text-align:left"><span>valid_recall</span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><span>fold1</span></td>
<td style="text-align:left"><span>0.55</span></td>
<td style="text-align:left"><span>0.48</span></td>
<td style="text-align:left"><span>0.57</span></td>
<td style="text-align:left"><span>0.51</span></td>
<td style="text-align:left"><span>0.56</span></td>
<td style="text-align:left"><span>0.39</span></td>
<td style="text-align:left"><span>0.31</span></td>
<td style="text-align:left"><span>0.24</span></td>
</tr>
<tr>
<td style="text-align:left"><span>fold2</span></td>
<td style="text-align:left"><span>0.53</span></td>
<td style="text-align:left"><span>0.55</span></td>
<td style="text-align:left"><span>0.57</span></td>
<td style="text-align:left"><span>0.56</span></td>
<td style="text-align:left"><span>0.56</span></td>
<td style="text-align:left"><span>0.66</span></td>
<td style="text-align:left"><span>0.18</span></td>
<td style="text-align:left"><span>0.18</span></td>
</tr>
<tr>
<td style="text-align:left"><span>fold3</span></td>
<td style="text-align:left"><span>0.54</span></td>
<td style="text-align:left"><span>0.5</span></td>
<td style="text-align:left"><span>0.56</span></td>
<td style="text-align:left"><span>0.52</span></td>
<td style="text-align:left"><span>0.53</span></td>
<td style="text-align:left"><span>0.44</span></td>
<td style="text-align:left"><span>0.32</span></td>
<td style="text-align:left"><span>0.27</span></td>
</tr>
<tr>
<td style="text-align:left"><span>fold4</span></td>
<td style="text-align:left"><span>0.53</span></td>
<td style="text-align:left"><span>0.55</span></td>
<td style="text-align:left"><span>0.56</span></td>
<td style="text-align:left"><span>0.57</span></td>
<td style="text-align:left"><span>0.54</span></td>
<td style="text-align:left"><span>0.58</span></td>
<td style="text-align:left"><span>0.21</span></td>
<td style="text-align:left"><span>0.23</span></td>
</tr>
<tr>
<td style="text-align:left"><span>fold5</span></td>
<td style="text-align:left"><span>0.54</span></td>
<td style="text-align:left"><span>0.54</span></td>
<td style="text-align:left"><span>0.57</span></td>
<td style="text-align:left"><span>0.56</span></td>
<td style="text-align:left"><span>0.54</span></td>
<td style="text-align:left"><span>0.53</span></td>
<td style="text-align:left"><span>0.3</span></td>
<td style="text-align:left"><span>0.27</span></td>
</tr>
<tr>
<td style="text-align:left"><span>ave</span></td>
<td style="text-align:left"><span>0.54</span></td>
<td style="text-align:left"><span>0.52</span></td>
<td style="text-align:left"><span>0.57</span></td>
<td style="text-align:left"><span>0.55</span></td>
<td style="text-align:left"><span>0.55</span></td>
<td style="text-align:left"><span>0.52</span></td>
<td style="text-align:left"><span>0.27</span></td>
<td style="text-align:left"><span>0.24</span></td>
</tr>
</tbody>
</table><ul>
<li><span>Step4: 對整筆train data做訓練</span></li>
<li><span>Step5: 最終結果</span></li>
</ul><table>
<thead>
<tr>
<th style="text-align:left"><span>TrainData</span></th>
<th style="text-align:left"><span>value</span></th>
<th style="text-align:left"><span>TestData</span></th>
<th style="text-align:left"><span>value</span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><span>Accuracy</span></td>
<td style="text-align:left"><span>0.56</span></td>
<td style="text-align:left"><span>Accuracy</span></td>
<td style="text-align:left"><span>0.54</span></td>
</tr>
<tr>
<td style="text-align:left"><span>Precision</span></td>
<td style="text-align:left"><span>0.53</span></td>
<td style="text-align:left"><span>Precision</span></td>
<td style="text-align:left"><span>0.5</span></td>
</tr>
<tr>
<td style="text-align:left"><span>Recall</span></td>
<td style="text-align:left"><span>0.26</span></td>
<td style="text-align:left"><span>Recall</span></td>
<td style="text-align:left"><span>0.37</span></td>
</tr>
<tr>
<td style="text-align:left"><span>AUC</span></td>
<td style="text-align:left"><span>0.53</span></td>
<td style="text-align:left"><span>AUC</span></td>
<td style="text-align:left"><span>0.53</span></td>
</tr>
</tbody>
</table><h4 id="AUC" data-id="AUC"><a class="anchor hidden-xs" href="#AUC" title="AUC"><span class="octicon octicon-link"></span></a><span>AUC</span></h4><p><img src="https://i.imgur.com/OG3QcDv.png" alt="train data" loading="lazy"><br>
<img src="https://i.imgur.com/5cBUIgK.png" alt="test data" loading="lazy"></p><h3 id="QDA" data-id="QDA"><a class="anchor hidden-xs" href="#QDA" title="QDA"><span class="octicon octicon-link"></span></a><span>QDA</span></h3><h3 id="NaiveBayes" data-id="NaiveBayes"><a class="anchor hidden-xs" href="#NaiveBayes" title="NaiveBayes"><span class="octicon octicon-link"></span></a><span>NaiveBayes</span></h3><h3 id="Decision-Tree" data-id="Decision-Tree"><a class="anchor hidden-xs" href="#Decision-Tree" title="Decision-Tree"><span class="octicon octicon-link"></span></a><span>Decision Tree</span></h3><p><span>請使用以下Rscript 執行:</span></p><pre><code class="R hljs">Rscript code/G1_DecisionTree.R --input data/ourdata.csv --output results/G1_Decision_tree.csv
</code></pre><ul>
<li>
<p><span>step 1:先使用ourdata.csv作為訓練資料，將最後100筆切為最終測試資料</span></p>
</li>
<li>
<p><span>strp 2:剩下的資料進行three-way split(0.6,0.2,0.2)，再進行5-fold cross-validation</span></p>
</li>
<li>
<p><span>step 3:再把全部的測試資料拿去訓練模型並預測自身結果</span></p>
</li>
<li>
<p><span>step 4:最終再對最終測試資料進行預測，輸出結果</span></p>
</li>
<li>
<p><a href="https://github.com/1101-datascience/finalproject-finalproject_group1/blob/main/results/G1_Decision_tree_without_diff.csv" target="_blank" rel="noopener"><span>export file</span></a></p>
</li>
</ul><h4 id="improvement" data-id="improvement"><a class="anchor hidden-xs" href="#improvement" title="improvement"><span class="octicon octicon-link"></span></a><span>improvement</span></h4><pre><code class="R hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span></div><div class="code">##Preprocessing##
doc &lt;- read.csv(<span class="hljs-string">'ourdata.csv'</span>)

##change <span class="hljs-keyword">class</span>##
doc$date..t. &lt;- <span class="hljs-keyword">as</span>.Date(doc$date..t.)
doc$S_P_500_Close..t<span class="hljs-number">.1</span>. &lt;- gsub(<span class="hljs-string">','</span>,<span class="hljs-string">''</span>,doc$S_P_500_Close..t<span class="hljs-number">.1</span>.)
doc$S_P_500_Close..t<span class="hljs-number">.1</span>. &lt;- <span class="hljs-keyword">as</span>.numeric(doc$S_P_500_Close..t<span class="hljs-number">.1</span>.)
doc$total_net_tsmc..t<span class="hljs-number">.1</span>. &lt;- <span class="hljs-keyword">as</span>.numeric(doc$total_net_tsmc..t<span class="hljs-number">.1</span>.)
doc$TAIEX..t. &lt;- <span class="hljs-keyword">as</span>.factor(doc$TAIEX..t.)
doc$Bitcoin_Change...t<span class="hljs-number">.1</span>. &lt;- round(doc$Bitcoin_Change...t<span class="hljs-number">.1</span>.,<span class="hljs-number">2</span>)
##creating columns##

##function to calculate difference##
fluctuate &lt;- function(n){
  diff=c()
  for (i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:length(n)<span class="hljs-number">-1</span>) {
    diff[i]=round((n[i+<span class="hljs-number">1</span>]-n[i])*<span class="hljs-number">100</span>/n[i],<span class="hljs-number">2</span>) 
  }
  return(diff)
}

##difference <span class="hljs-keyword">in</span> Dow_Jones##
contain1 &lt;- c(<span class="hljs-number">0.03</span>)
contain1 &lt;- append(contain1,fluctuate(doc$Dow.Jones_Close..t<span class="hljs-number">.1</span>.))
doc$Dow.Jones_diff &lt;- contain1

##difference <span class="hljs-keyword">in</span> NASDAQ##
contain2 &lt;- c(<span class="hljs-number">0.17</span>)
contain2 &lt;- append(contain2,fluctuate(doc$NASDAQ_Close..t<span class="hljs-number">.1</span>.))
doc$NASDAQ_diff &lt;- contain2

##difference <span class="hljs-keyword">in</span> S&amp;P <span class="hljs-number">500</span>##
contain3 &lt;- c(<span class="hljs-number">0.33</span>)
contain3 &lt;- append(contain3,fluctuate(doc$S_P_500_Close..t<span class="hljs-number">.1</span>.))
doc$S_P_500_diff &lt;- contain3

##difference <span class="hljs-keyword">in</span> SOX##
contain4 &lt;- c(<span class="hljs-number">0.15</span>)
contain4 &lt;- append(contain4,fluctuate(doc$SOX_Close..t<span class="hljs-number">.1</span>.))
doc$SOX_diff &lt;- contain4

##Selecting variables##
doc2 &lt;- doc[c(<span class="hljs-number">1</span>,<span class="hljs-number">5</span>,<span class="hljs-number">7</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">8</span>)]
</div></div></code></pre><ul>
<li><span>再讀進ourdata.csv後，先利用上述的code進行preprocessing,創造出漲跌幅的columns，然後只使用這些columns進行訓練及預測，訓練模型以及預測過程同上述之step 2~step 4。</span></li>
</ul><p><a href="https://github.com/1101-datascience/finalproject-finalproject_group1/blob/main/results/G1_Decision_tree.csv" target="_blank" rel="noopener"><span>improvement</span></a></p><p><span>[ROC Curve by 漲跌幅]</span><br>
<img src="https://i.imgur.com/wqz2nxz.jpg" alt="" loading="lazy"></p><h3 id="Random-Forest" data-id="Random-Forest"><a class="anchor hidden-xs" href="#Random-Forest" title="Random-Forest"><span class="octicon octicon-link"></span></a><span>Random Forest</span></h3><h4 id="import1" data-id="import"><a class="anchor hidden-xs" href="#import1" title="import1"><span class="octicon octicon-link"></span></a><span>import</span></h4><pre><code class="R hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span></div><div class="code"><span class="hljs-function"><span class="hljs-title">library</span><span class="hljs-params">(<span class="hljs-string">'lattice'</span>)</span></span>
<span class="hljs-function"><span class="hljs-title">library</span><span class="hljs-params">(<span class="hljs-string">'ggplot2'</span>)</span></span>
<span class="hljs-function"><span class="hljs-title">library</span><span class="hljs-params">(<span class="hljs-string">'caret'</span>)</span></span>
<span class="hljs-function"><span class="hljs-title">library</span><span class="hljs-params">(<span class="hljs-string">'randomForest'</span>)</span></span>
<span class="hljs-function"><span class="hljs-title">library</span><span class="hljs-params">(<span class="hljs-string">'pROC'</span>)</span></span>
<span class="hljs-function"><span class="hljs-title">library</span><span class="hljs-params">(<span class="hljs-string">'ROCR'</span>)</span></span>
</div></div></code></pre><h4 id="Data-pre-processing1" data-id="Data-pre-processing"><a class="anchor hidden-xs" href="#Data-pre-processing1" title="Data-pre-processing1"><span class="octicon octicon-link"></span></a><span>Data pre-processing</span></h4><div class="alert alert-info">
<p><span>對data做min-max正規化</span></p>
</div><h4 id="Model-參數1" data-id="Model-參數"><a class="anchor hidden-xs" href="#Model-參數1" title="Model-參數1"><span class="octicon octicon-link"></span></a><span>Model 參數</span></h4><pre><code class="R hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span></div><div class="code">rf_model &lt;- randomForest(factor(TAIEX<span class="hljs-built_in">..</span>t.) ~ ., 
		data = myTrainingData,<span class="hljs-attribute">mtry</span>=2, 
		<span class="hljs-attribute">importance</span>=<span class="hljs-literal">TRUE</span>, <span class="hljs-attribute">ntree</span>=100, <span class="hljs-attribute">nodesize</span>=7)
</div></div></code></pre><h4 id="Rscript-command1" data-id="Rscript-command"><a class="anchor hidden-xs" href="#Rscript-command1" title="Rscript-command1"><span class="octicon octicon-link"></span></a><span>Rscript command</span></h4><ul>
<li><span>使用</span><code>G1_RF.R</code><span>，按照以下方式執行:</span></li>
</ul><pre><code class="R hljs">Rscript G1_RF<span class="hljs-selector-class">.R</span> <span class="hljs-attr">--fold</span> <span class="hljs-number">5</span> <span class="hljs-attr">--input</span> <span class="hljs-selector-attr">[dataset_path]</span>  <span class="hljs-attr">--report</span> <span class="hljs-selector-attr">[report_path]</span>
</code></pre><h4 id="步驟1" data-id="步驟"><a class="anchor hidden-xs" href="#步驟1" title="步驟1"><span class="octicon octicon-link"></span></a><span>步驟</span></h4><ul>
<li><span>Step1: 將資料最後100筆切為test data</span></li>
<li><span>Step2: 剩下的train data 拿去訓練以及5-fold cross validation(train/validation比例0.8: 0.2)</span></li>
<li><span>Step3: cross validation 結果</span></li>
</ul><table>
<thead>
<tr>
<th style="text-align:left"><span>RF_Model</span></th>
<th style="text-align:left"><span>Train_AUC</span></th>
<th style="text-align:left"><span>Valid_AUC</span></th>
<th style="text-align:left"><span>Train_AC</span></th>
<th style="text-align:left"><span>Valid_AC</span></th>
<th style="text-align:left"><span>Train_Precision</span></th>
<th style="text-align:left"><span>Valid_Precision</span></th>
<th style="text-align:left"><span>Train_Recall</span></th>
<th style="text-align:left"><span>Valid_Recall</span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><span>fold1</span></td>
<td style="text-align:left"><span>0.96</span></td>
<td style="text-align:left"><span>0.91</span></td>
<td style="text-align:left"><span>0.87</span></td>
<td style="text-align:left"><span>0.83</span></td>
<td style="text-align:left"><span>0.86</span></td>
<td style="text-align:left"><span>0.84</span></td>
<td style="text-align:left"><span>0.91</span></td>
<td style="text-align:left"><span>0.87</span></td>
</tr>
<tr>
<td style="text-align:left"><span>fold2</span></td>
<td style="text-align:left"><span>0.96</span></td>
<td style="text-align:left"><span>0.95</span></td>
<td style="text-align:left"><span>0.87</span></td>
<td style="text-align:left"><span>0.88</span></td>
<td style="text-align:left"><span>0.86</span></td>
<td style="text-align:left"><span>0.86</span></td>
<td style="text-align:left"><span>0.91</span></td>
<td style="text-align:left"><span>0.93</span></td>
</tr>
<tr>
<td style="text-align:left"><span>fold3</span></td>
<td style="text-align:left"><span>0.96</span></td>
<td style="text-align:left"><span>0.95</span></td>
<td style="text-align:left"><span>0.87</span></td>
<td style="text-align:left"><span>0.9</span></td>
<td style="text-align:left"><span>0.86</span></td>
<td style="text-align:left"><span>0.92</span></td>
<td style="text-align:left"><span>0.91</span></td>
<td style="text-align:left"><span>0.89</span></td>
</tr>
<tr>
<td style="text-align:left"><span>fold4</span></td>
<td style="text-align:left"><span>0.96</span></td>
<td style="text-align:left"><span>0.95</span></td>
<td style="text-align:left"><span>0.87</span></td>
<td style="text-align:left"><span>0.91</span></td>
<td style="text-align:left"><span>0.86</span></td>
<td style="text-align:left"><span>0.9</span></td>
<td style="text-align:left"><span>0.91</span></td>
<td style="text-align:left"><span>0.92</span></td>
</tr>
<tr>
<td style="text-align:left"><span>fold5</span></td>
<td style="text-align:left"><span>0.96</span></td>
<td style="text-align:left"><span>0.95</span></td>
<td style="text-align:left"><span>0.87</span></td>
<td style="text-align:left"><span>0.89</span></td>
<td style="text-align:left"><span>0.86</span></td>
<td style="text-align:left"><span>0.9</span></td>
<td style="text-align:left"><span>0.91</span></td>
<td style="text-align:left"><span>0.89</span></td>
</tr>
<tr>
<td style="text-align:left"><span>ave.</span></td>
<td style="text-align:left"><span>0.96</span></td>
<td style="text-align:left"><span>0.94</span></td>
<td style="text-align:left"><span>0.87</span></td>
<td style="text-align:left"><span>0.88</span></td>
<td style="text-align:left"><span>0.86</span></td>
<td style="text-align:left"><span>0.89</span></td>
<td style="text-align:left"><span>0.91</span></td>
<td style="text-align:left"><span>0.9</span></td>
</tr>
</tbody>
</table><ul>
<li><span>Step4: 對整筆train data做訓練</span></li>
<li><span>Step5: 最終結果</span></li>
</ul><table>
<thead>
<tr>
<th style="text-align:left"><span>TrainData</span></th>
<th style="text-align:left"><span>value</span></th>
<th style="text-align:left"><span>TestData</span></th>
<th style="text-align:left"><span>value</span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><span>Accuracy</span></td>
<td style="text-align:left"><span>0.86</span></td>
<td style="text-align:left"><span>Accuracy</span></td>
<td style="text-align:left"><span>0.62</span></td>
</tr>
<tr>
<td style="text-align:left"><span>Precision</span></td>
<td style="text-align:left"><span>0.85</span></td>
<td style="text-align:left"><span>Precision</span></td>
<td style="text-align:left"><span>0.62</span></td>
</tr>
<tr>
<td style="text-align:left"><span>Recall</span></td>
<td style="text-align:left"><span>0.91</span></td>
<td style="text-align:left"><span>Recall</span></td>
<td style="text-align:left"><span>0.64</span></td>
</tr>
<tr>
<td style="text-align:left"><span>AUC</span></td>
<td style="text-align:left"><span>0.96</span></td>
<td style="text-align:left"><span>AUC</span></td>
<td style="text-align:left"><span>0.61</span></td>
</tr>
</tbody>
</table><h4 id="AUC1" data-id="AUC"><a class="anchor hidden-xs" href="#AUC1" title="AUC1"><span class="octicon octicon-link"></span></a><span>AUC</span></h4><p><img src="https://imgur.com/IsQlUi3.png" alt="train data" loading="lazy"><br>
<img src="https://imgur.com/WKUXD0H.png" alt="test data" loading="lazy"></p><h3 id="SVM" data-id="SVM"><a class="anchor hidden-xs" href="#SVM" title="SVM"><span class="octicon octicon-link"></span></a><span>SVM</span></h3><h4 id="import2" data-id="import"><a class="anchor hidden-xs" href="#import2" title="import2"><span class="octicon octicon-link"></span></a><span>import</span></h4><pre><code class="R hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span>
<span></span></div><div class="code"><span class="hljs-function"><span class="hljs-title">library</span><span class="hljs-params">(ROCR)</span></span>
<span class="hljs-function"><span class="hljs-title">library</span><span class="hljs-params">(e1071)</span></span>
<span class="hljs-function"><span class="hljs-title">library</span><span class="hljs-params">(caret)</span></span>
<span class="hljs-function"><span class="hljs-title">library</span><span class="hljs-params">(gridExtra)</span></span>
</div></div></code></pre><h4 id="Data-pre-processing2" data-id="Data-pre-processing"><a class="anchor hidden-xs" href="#Data-pre-processing2" title="Data-pre-processing2"><span class="octicon octicon-link"></span></a><span>Data pre-processing</span></h4><div class="alert alert-info">
<p><span>使用model 自己的scale進行正規化</span><br>
<span>主要使用原始的dataset以及轉換為’漲跌比例的欄位。</span></p>
</div><h4 id="參數選擇" data-id="參數選擇"><a class="anchor hidden-xs" href="#參數選擇" title="參數選擇"><span class="octicon octicon-link"></span></a><span>參數選擇</span></h4><div class="alert alert-info">
<p><span>這次主要嘗試使用</span><code>e1071</code><span>、</span><code>caret</code><span>的</span><span style="color:red"><span>網格搜尋</span></span><span>方式進行調整參數。</span></p>
</div><h5 id="參數選擇1e107調整參數以及其訓練結果" data-id="參數選擇1e107調整參數以及其訓練結果"><a class="anchor hidden-xs" href="#參數選擇1e107調整參數以及其訓練結果" title="參數選擇1e107調整參數以及其訓練結果"><span class="octicon octicon-link"></span></a><span>參數選擇1:e107調整參數以及其訓練結果</span></h5><pre><code class="R hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span></div><div class="code"><span class="hljs-comment"># in svm_best_linear_param.R</span>
<span class="hljs-comment"># 調整kernal</span>
svmtune &lt;-  tune(svm,TAIEX<span class="hljs-built_in">..</span>t.~., <span class="hljs-attribute">data</span>=train_data,probability=TRUE,scale = <span class="hljs-literal">TRUE</span>, 
                 <span class="hljs-attribute">range</span>=list(kernel=c("linear", <span class="hljs-string">"polynomial"</span>,<span class="hljs-string">"radial"</span>),<span class="hljs-attribute">cost</span>=seq(0.2,1,0.2)),
                 <span class="hljs-attribute">tunecontrol</span>=tune.control(sampling = <span class="hljs-string">"cross"</span>,cross = k,<span class="hljs-attribute">performances</span>=<span class="hljs-literal">TRUE</span>))
write.table(data.frame(svmtune<span class="hljs-variable">$performances</span>),<span class="hljs-attribute">file</span>=<span class="hljs-string">'results/SVM_tune_kernal_e1071.csv'</span>,quote=FALSE,sep=",",row.names=FALSE, na = <span class="hljs-string">"NA"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">'best.parameters'</span>)
<span class="hljs-built_in">print</span>(svmtune<span class="hljs-variable">$best</span>.parameters)

<span class="hljs-comment"># 調整linear</span>
svmtune &lt;-  tune(svm,TAIEX<span class="hljs-built_in">..</span>t.~., <span class="hljs-attribute">data</span>=train_data,probability=TRUE,scale = <span class="hljs-literal">TRUE</span>, <span class="hljs-attribute">kernel</span>=<span class="hljs-string">"linear"</span>,cost=0.4,
                 <span class="hljs-attribute">range</span>=list(epsilon=10^c(-1,-2,-3),tolerance=10^c(-1,-2,-3)),
                 <span class="hljs-attribute">tunecontrol</span>=tune.control(sampling = <span class="hljs-string">"cross"</span>,cross = k,<span class="hljs-attribute">performances</span>=<span class="hljs-literal">TRUE</span>))
write.table(data.frame(svmtune<span class="hljs-variable">$performances</span>),<span class="hljs-attribute">file</span>=<span class="hljs-string">'results/SVM_tune_linear_kernal_e1071.csv'</span>,quote=FALSE,sep=",",row.names=FALSE, na = <span class="hljs-string">"NA"</span>)
plot(svmtune)
<span class="hljs-built_in">print</span>(<span class="hljs-string">'best.parameters'</span>)
<span class="hljs-built_in">print</span>(svmtune<span class="hljs-variable">$best</span>.parameters)
</div></div></code></pre><h6 id="Step1先比較kernal的差異" data-id="Step1先比較kernal的差異"><a class="anchor hidden-xs" href="#Step1先比較kernal的差異" title="Step1先比較kernal的差異"><span class="octicon octicon-link"></span></a><strong><span>Step1:先比較kernal的差異</span></strong></h6><ul>
<li><span>先取</span><code>kernal</code><span>=“linear”, “polynomial”,“radial”，"sigmoid"以及cost=0.2、0.4、0.6 、0.8、1.0的參數組合，對</span><code>our_data.csv</code><span>進行5-fold交叉驗證。</span></li>
<li><span>最佳結果(loss最小)為kernal=linear,cost=1。</span></li>
</ul><h6 id="Step2針對linear進行調參" data-id="Step2針對linear進行調參"><a class="anchor hidden-xs" href="#Step2針對linear進行調參" title="Step2針對linear進行調參"><span class="octicon octicon-link"></span></a><strong><span>Step2:針對linear進行調參</span></strong></h6><ul>
<li><span>linear沒有特別的讀有參數，因此選擇最次針對epsilon=10^c(-1,-2,-3) 、tolerance=10^c(-1,-2,-3)這兩個進行調整，結果如下:</span></li>
<li><img src="https://i.imgur.com/V6fG87E.png" alt="" loading="lazy"></li>
<li><span>最終結果為預設的參表現</span><code>tolerance=0.1</code><span>、</span><code>epsilon=0.01</code><span>最好(loss最小)。</span></li>
</ul><blockquote>
<p><span>上述的調參可由執行svm_best_linear_param.R而得，可以產生調參的紀錄檔案。</span></p>
<ul>
<li><span>檔案</span><code>SVM_tune_kernal_e1071.csv</code><span>為step1。</span></li>
<li><span>檔案</span><code>SVM_tune_linear_kernal_e1071.csv</code><span>為Step2。</span><br>
<span>重複執行會發現每次進行之結果kernal接固定在’linear’，但Cost的選擇因為loss差距十分小因此不一定能重現。</span></li>
</ul>
</blockquote><h5 id="Step3-將這組參數進行訊鍊與預測，產生結果" data-id="Step3-將這組參數進行訊鍊與預測，產生結果"><a class="anchor hidden-xs" href="#Step3-將這組參數進行訊鍊與預測，產生結果" title="Step3-將這組參數進行訊鍊與預測，產生結果"><span class="octicon octicon-link"></span></a><strong><span>Step3: 將這組參數進行訊鍊與預測，產生結果</span></strong><span>:</span></h5><div class="alert alert-info">
<p><span>分為 ourdata,csv、only_diff.csv進行比較。</span></p>
</div><ul>
<li><span>使用</span><code>G1_svm_linear.R</code><span>，按照以下方式執行:</span></li>
</ul><pre><code class="R hljs">Rscript G1_svm_linear<span class="hljs-selector-class">.R</span> <span class="hljs-attr">--train_path</span> <span class="hljs-selector-attr">[dataset_path]</span>  <span class="hljs-attr">--report_path</span> <span class="hljs-selector-attr">[report_path]</span>
</code></pre><h5 id="在ourdata上表現的結果如下" data-id="在ourdata上表現的結果如下"><a class="anchor hidden-xs" href="#在ourdata上表現的結果如下" title="在ourdata上表現的結果如下"><span class="octicon octicon-link"></span></a><span>在ourdata上表現的結果如下:</span></h5><ul>
<li><span>交叉驗證</span></li>
</ul><table>
<thead>
<tr>
<th><span>ACC</span></th>
<th><span>train_ACC</span></th>
<th><span>validation_ACC</span></th>
<th><span>recall</span></th>
<th><span>train_recall</span></th>
<th><span>validation_recall</span></th>
<th><span>percion</span></th>
<th><span>training_p</span></th>
<th><span>validation_p</span></th>
<th><span>AUC</span></th>
<th><span>train_AUC</span></th>
<th><span>validation_AUC</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>fold1</span></td>
<td><span>1</span></td>
<td><span>0.54</span></td>
<td><span>fold1</span></td>
<td><span>1</span></td>
<td><span>0.89</span></td>
<td><span>fold1</span></td>
<td><span>1</span></td>
<td><span>0.54</span></td>
<td><span>fold1</span></td>
<td><span>1</span></td>
<td><span>0.51</span></td>
</tr>
<tr>
<td><span>fold2</span></td>
<td><span>1</span></td>
<td><span>0.54</span></td>
<td><span>fold2</span></td>
<td><span>1</span></td>
<td><span>0.86</span></td>
<td><span>fold2</span></td>
<td><span>1</span></td>
<td><span>0.54</span></td>
<td><span>fold2</span></td>
<td><span>1</span></td>
<td><span>0.49</span></td>
</tr>
<tr>
<td><span>fold3</span></td>
<td><span>1</span></td>
<td><span>0.59</span></td>
<td><span>fold3</span></td>
<td><span>1</span></td>
<td><span>0.93</span></td>
<td><span>fold3</span></td>
<td><span>1</span></td>
<td><span>0.59</span></td>
<td><span>fold3</span></td>
<td><span>1</span></td>
<td><span>0.55</span></td>
</tr>
<tr>
<td><span>fold4</span></td>
<td><span>1</span></td>
<td><span>0.52</span></td>
<td><span>fold4</span></td>
<td><span>1</span></td>
<td><span>0.94</span></td>
<td><span>fold4</span></td>
<td><span>1</span></td>
<td><span>0.52</span></td>
<td><span>fold4</span></td>
<td><span>1</span></td>
<td><span>0.48</span></td>
</tr>
<tr>
<td><span>fold5</span></td>
<td><span>1</span></td>
<td><span>0.58</span></td>
<td><span>fold5</span></td>
<td><span>1</span></td>
<td><span>0.93</span></td>
<td><span>fold5</span></td>
<td><span>1</span></td>
<td><span>0.59</span></td>
<td><span>fold5</span></td>
<td><span>1</span></td>
<td><span>0.55</span></td>
</tr>
<tr>
<td><span>ave.</span></td>
<td><span>1</span></td>
<td><span>0.55</span></td>
<td><span>ave.</span></td>
<td><span>1</span></td>
<td><span>0.91</span></td>
<td><span>ave.</span></td>
<td><span>1</span></td>
<td><span>0.56</span></td>
<td><span>ave.</span></td>
<td><span>1</span></td>
<td><span>0.52</span></td>
</tr>
</tbody>
</table><ul>
<li><span>最終在train 、test上之表現</span></li>
</ul><table>
<thead>
<tr>
<th><span>Mectrics</span></th>
<th><span>train</span></th>
<th><span>test</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>ACC</span></td>
<td><span>1</span></td>
<td><span>0.49</span></td>
</tr>
<tr>
<td><span>Percision</span></td>
<td><span>0.54604</span></td>
<td><span>0.494949</span></td>
</tr>
<tr>
<td><span>Recall</span></td>
<td><span>0.98</span></td>
<td><span>0.98</span></td>
</tr>
<tr>
<td><span>AUC</span></td>
<td><span>1</span></td>
<td><span>0.482</span></td>
</tr>
<tr>
<td><span>ROC Curve</span></td>
<td><img src="https://i.imgur.com/jNyDl80.png" alt="" loading="lazy"></td>
<td><img src="https://i.imgur.com/08uM2P7.png" alt="" loading="lazy"></td>
</tr>
</tbody>
</table><h5 id="在only_diffcsv上表現的結果如下" data-id="在only_diffcsv上表現的結果如下"><a class="anchor hidden-xs" href="#在only_diffcsv上表現的結果如下" title="在only_diffcsv上表現的結果如下"><span class="octicon octicon-link"></span></a><span>在only_diff.csv上表現的結果如下:</span></h5><ul>
<li><span>交叉驗證:</span></li>
</ul><table>
<thead>
<tr>
<th><span>ACC</span></th>
<th><span>train_ACC</span></th>
<th><span>validation_ACC</span></th>
<th><span>recall</span></th>
<th><span>train_recall</span></th>
<th><span>validation_recall</span></th>
<th><span>percion</span></th>
<th><span>training_p</span></th>
<th><span>validation_p</span></th>
<th><span>AUC</span></th>
<th><span>train_AUC</span></th>
<th><span>validation_AUC</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>fold1</span></td>
<td><span>1</span></td>
<td><span>0.61</span></td>
<td><span>fold1</span></td>
<td><span>0.99</span></td>
<td><span>0.78</span></td>
<td><span>fold1</span></td>
<td><span>1</span></td>
<td><span>0.61</span></td>
<td><span>fold1</span></td>
<td><span>1</span></td>
<td><span>0.68</span></td>
</tr>
<tr>
<td><span>fold2</span></td>
<td><span>0.99</span></td>
<td><span>0.61</span></td>
<td><span>fold2</span></td>
<td><span>0.99</span></td>
<td><span>0.8</span></td>
<td><span>fold2</span></td>
<td><span>0.99</span></td>
<td><span>0.6</span></td>
<td><span>fold2</span></td>
<td><span>1</span></td>
<td><span>0.65</span></td>
</tr>
<tr>
<td><span>fold3</span></td>
<td><span>1</span></td>
<td><span>0.67</span></td>
<td><span>fold3</span></td>
<td><span>0.99</span></td>
<td><span>0.81</span></td>
<td><span>fold3</span></td>
<td><span>1</span></td>
<td><span>0.67</span></td>
<td><span>fold3</span></td>
<td><span>1</span></td>
<td><span>0.71</span></td>
</tr>
<tr>
<td><span>fold4</span></td>
<td><span>1</span></td>
<td><span>0.59</span></td>
<td><span>fold4</span></td>
<td><span>1</span></td>
<td><span>0.84</span></td>
<td><span>fold4</span></td>
<td><span>1</span></td>
<td><span>0.57</span></td>
<td><span>fold4</span></td>
<td><span>1</span></td>
<td><span>0.69</span></td>
</tr>
<tr>
<td><span>fold5</span></td>
<td><span>0.99</span></td>
<td><span>0.61</span></td>
<td><span>fold5</span></td>
<td><span>0.99</span></td>
<td><span>0.79</span></td>
<td><span>fold5</span></td>
<td><span>1</span></td>
<td><span>0.63</span></td>
<td><span>fold5</span></td>
<td><span>1</span></td>
<td><span>0.65</span></td>
</tr>
<tr>
<td><span>ave.</span></td>
<td><span>0.99</span></td>
<td><span>0.62</span></td>
<td><span>ave.</span></td>
<td><span>0.99</span></td>
<td><span>0.8</span></td>
<td><span>ave.</span></td>
<td><span>1</span></td>
<td><span>0.62</span></td>
<td><span>ave.</span></td>
<td><span>1</span></td>
<td><span>0.68</span></td>
</tr>
</tbody>
</table><ul>
<li><span>最終在train 、test上之表現</span></li>
</ul><table>
<thead>
<tr>
<th><span>Mectrics</span></th>
<th><span>train</span></th>
<th><span>test</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>ACC</span></td>
<td><span>0.995493</span></td>
<td><span>0.51</span></td>
</tr>
<tr>
<td><span>Percision</span></td>
<td><span>0.545925</span></td>
<td><span>0.507246</span></td>
</tr>
<tr>
<td><span>Recall</span></td>
<td><span>0.7</span></td>
<td><span>0.7</span></td>
</tr>
<tr>
<td><span>AUC</span></td>
<td><span>0.998667</span></td>
<td><span>0.6008</span></td>
</tr>
<tr>
<td><span>ROC Curve</span></td>
<td><img src="https://i.imgur.com/R7Cv43g.jpg" alt="" loading="lazy"></td>
<td><img src="https://i.imgur.com/VoBYpNP.jpg" alt="" loading="lazy"></td>
</tr>
</tbody>
</table><blockquote>
<p><span>使用漲跌幅的話，準確率顯著提升且超過Null model。</span></p>
</blockquote><h4 id="參數選擇使用carte" data-id="參數選擇使用carte"><a class="anchor hidden-xs" href="#參數選擇使用carte" title="參數選擇使用carte"><span class="octicon octicon-link"></span></a><span>參數選擇:使用carte</span></h4><div class="alert alert-info">
<p><span>上述的調參順序使先使用預設的結果進行，由於在ourdata.csv中的AUC成效較差。因此嘗是分別針對各個kernal的參數進行網格搜尋。進而比較彼此的結果。</span></p>
</div><h6 id="Step1針對各種kernal-進行調參" data-id="Step1針對各種kernal-進行調參"><a class="anchor hidden-xs" href="#Step1針對各種kernal-進行調參" title="Step1針對各種kernal-進行調參"><span class="octicon octicon-link"></span></a><strong><span>Step1:針對各種kernal 進行調參</span></strong></h6><pre><code class="R hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span>
<span></span></div><div class="code">train_control &lt;- trainControl(<span class="hljs-attr">method="repeatedcv",</span> <span class="hljs-attr">number=5,</span> <span class="hljs-attr">repeats=1)</span>
svm_linear &lt;- train(TAIEX..t. ~., <span class="hljs-attr">data</span> = train_data[,<span class="hljs-number">2</span>:ncol(train_data)], <span class="hljs-attr">method</span> = <span class="hljs-string">"svmLinear"</span>, <span class="hljs-attr">trControl</span> = train_control,  <span class="hljs-attr">preProcess</span> = c(<span class="hljs-string">"scale"</span>), <span class="hljs-attr">tuneGrid</span> = expand.grid(<span class="hljs-attr">C</span> = seq(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-attr">length</span> =<span class="hljs-number">21</span>) ))
svm_Radial &lt;- train(TAIEX..t. ~., <span class="hljs-attr">data</span> = train_data[,<span class="hljs-number">2</span>:ncol(train_data)], <span class="hljs-attr">method</span> = <span class="hljs-string">"svmRadial"</span>, <span class="hljs-attr">trControl</span> = train_control, <span class="hljs-attr">preProcess</span> = c(<span class="hljs-string">"scale"</span>), <span class="hljs-attr">tuneLength</span> = <span class="hljs-number">10</span>)
svm_ploy &lt;- train(TAIEX..t. ~., <span class="hljs-attr">data</span> = train_data[,<span class="hljs-number">2</span>:ncol(train_data)], <span class="hljs-attr">method</span> = <span class="hljs-string">"svmPoly"</span>, <span class="hljs-attr">trControl</span> = train_control, <span class="hljs-attr">preProcess</span> = c(<span class="hljs-string">"scale"</span>), <span class="hljs-attr">tuneLength</span> = <span class="hljs-number">5</span>)
</div></div></code></pre><h6 id="Step2-各kenarl結果" data-id="Step2-各kenarl結果"><a class="anchor hidden-xs" href="#Step2-各kenarl結果" title="Step2-各kenarl結果"><span class="octicon octicon-link"></span></a><strong><span>Step2: 各kenarl結果</span></strong></h6><table>
<thead>
<tr>
<th><span>kernal</span></th>
<th><span>linear</span></th>
<th><span>polynomial</span></th>
<th><span>radial</span></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td><img src="https://i.imgur.com/SVOzuDZ.jpg" alt="" loading="lazy"></td>
<td><img src="https://i.imgur.com/MlkDY37.jpg" alt="" loading="lazy"></td>
<td><img src="https://i.imgur.com/M0NXQKV.jpg" alt="" loading="lazy"></td>
</tr>
<tr>
<td><span>最佳結果</span></td>
<td><span>C=9.5</span></td>
<td><span>(degree=1，scale=0.001，C=0.25)</span></td>
<td><span>(sigma=0.00030133,C=1)</span></td>
</tr>
<tr>
<td><span>準確率</span></td>
<td><span>0.49</span></td>
<td><span>0.543253685</span></td>
<td><span>0.543253685</span></td>
</tr>
<tr>
<td><span>備註</span></td>
<td><span>這次針對C的搜尋範圍有擴增，因此找到了與上次不同的參數。</span></td>
<td><span>可以看見最穩定預測的模型仍是以degree=1為主，加入polynomial的正則化後表現更好比單純linear更好</span></td>
<td><span>因為polynomail的選擇接近線性的kernal，radial是目前找到唯依表現較佳的由非線性kernal的參數組合</span></td>
</tr>
</tbody>
</table><blockquote>
<p><span>套件會依照Accuracy之SD大小排序，選擇其中Accuracy之SD最小、Accuracy 表現最佳者當首選模型。</span><br>
<span>本次實驗選擇radial的組合進行與測與分析。</span></p>
</blockquote><ul>
<li><span>詳細每個調參獲得之Acc可在以下檔案得到資訊</span>
<ul>
<li><span>results/SVM_linear.csv</span></li>
<li><span>results/SVM_rbf.csv</span></li>
<li><span>results/SVM_ploy.csv</span></li>
<li><span>檔案可以藉由執行svm_best_linear_param.產生</span></li>
</ul>
</li>
</ul><h6 id="Step-3-該參數組合在資料及上的表現結果" data-id="Step-3-該參數組合在資料及上的表現結果"><a class="anchor hidden-xs" href="#Step-3-該參數組合在資料及上的表現結果" title="Step-3-該參數組合在資料及上的表現結果"><span class="octicon octicon-link"></span></a><strong><span>Step 3 :該參數組合在資料及上的表現結果</span></strong></h6><ul>
<li><span>使用</span><code>G1_svm_linear.R</code><span>，按照以下方式執行:</span></li>
</ul><pre><code class="R hljs"><div class="wrapper"><div class="gutter linenumber"><span></span></div><div class="code">Rscript G1_SVM<span class="hljs-selector-class">.R</span> <span class="hljs-attr">--train_path</span> <span class="hljs-selector-attr">[dataset_path]</span>  <span class="hljs-attr">--report_path</span> <span class="hljs-selector-attr">[report_path]</span>
</div></div></code></pre><h5 id="在ourdata上表現的結果如下1" data-id="在ourdata上表現的結果如下"><a class="anchor hidden-xs" href="#在ourdata上表現的結果如下1" title="在ourdata上表現的結果如下1"><span class="octicon octicon-link"></span></a><span>在ourdata上表現的結果如下:</span></h5><ul>
<li><span>交叉驗證</span></li>
</ul><table>
<thead>
<tr>
<th><span>ACC</span></th>
<th><span>train_ACC</span></th>
<th><span>validation_ACC</span></th>
<th><span>recall</span></th>
<th><span>train_recall</span></th>
<th><span>validation_recall</span></th>
<th><span>percion</span></th>
<th><span>training_p</span></th>
<th><span>validation_p</span></th>
<th><span>AUC</span></th>
<th><span>train_AUC</span></th>
<th><span>validation_AUC</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>fold1</span></td>
<td><span>0.55</span></td>
<td><span>0.54</span></td>
<td><span>fold1</span></td>
<td><span>1</span></td>
<td><span>1</span></td>
<td><span>fold1</span></td>
<td><span>0.55</span></td>
<td><span>0.54</span></td>
<td><span>fold1</span></td>
<td><span>1</span></td>
<td><span>0.48</span></td>
</tr>
<tr>
<td><span>fold2</span></td>
<td><span>0.55</span></td>
<td><span>0.54</span></td>
<td><span>fold2</span></td>
<td><span>1</span></td>
<td><span>1</span></td>
<td><span>fold2</span></td>
<td><span>0.55</span></td>
<td><span>0.54</span></td>
<td><span>fold2</span></td>
<td><span>1</span></td>
<td><span>0.5</span></td>
</tr>
<tr>
<td><span>fold3</span></td>
<td><span>0.54</span></td>
<td><span>0.57</span></td>
<td><span>fold3</span></td>
<td><span>1</span></td>
<td><span>1</span></td>
<td><span>fold3</span></td>
<td><span>0.54</span></td>
<td><span>0.57</span></td>
<td><span>fold3</span></td>
<td><span>1</span></td>
<td><span>0.52</span></td>
</tr>
<tr>
<td><span>fold4</span></td>
<td><span>0.56</span></td>
<td><span>0.51</span></td>
<td><span>fold4</span></td>
<td><span>1</span></td>
<td><span>1</span></td>
<td><span>fold4</span></td>
<td><span>0.56</span></td>
<td><span>0.51</span></td>
<td><span>fold4</span></td>
<td><span>1</span></td>
<td><span>0.48</span></td>
</tr>
<tr>
<td><span>fold5</span></td>
<td><span>0.54</span></td>
<td><span>0.57</span></td>
<td><span>fold5</span></td>
<td><span>1</span></td>
<td><span>1</span></td>
<td><span>fold5</span></td>
<td><span>0.54</span></td>
<td><span>0.57</span></td>
<td><span>fold5</span></td>
<td><span>1</span></td>
<td><span>0.53</span></td>
</tr>
<tr>
<td><span>ave.</span></td>
<td><span>0.55</span></td>
<td><span>0.55</span></td>
<td><span>ave.</span></td>
<td><span>1</span></td>
<td><span>1</span></td>
<td><span>ave.</span></td>
<td><span>0.55</span></td>
<td><span>0.55</span></td>
<td><span>ave.</span></td>
<td><span>1</span></td>
<td><span>0.5</span></td>
</tr>
</tbody>
</table><ul>
<li><span>最終在train 、test上之表現</span></li>
</ul><table>
<thead>
<tr>
<th><span>Mectrics</span></th>
<th><span>train</span></th>
<th><span>test</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>ACC</span></td>
<td><span>0.54604</span></td>
<td><span>0.5</span></td>
</tr>
<tr>
<td><span>Percision</span></td>
<td><span>1</span></td>
<td><span>0.5</span></td>
</tr>
<tr>
<td><span>Recall</span></td>
<td><span>1</span></td>
<td><span>1</span></td>
</tr>
<tr>
<td><span>AUC</span></td>
<td><span>1</span></td>
<td><span>0.5072</span></td>
</tr>
<tr>
<td><span>ROC Curve</span></td>
<td><img src="https://i.imgur.com/ME2WUtR.jpg" alt="" loading="lazy"></td>
<td><img src="https://i.imgur.com/i4hoype.jpg" alt="" loading="lazy"></td>
</tr>
</tbody>
</table><h6 id="在only_diffcsv之表現" data-id="在only_diffcsv之表現"><a class="anchor hidden-xs" href="#在only_diffcsv之表現" title="在only_diffcsv之表現"><span class="octicon octicon-link"></span></a><span>在only_diff.csv之表現:</span></h6><ul>
<li><span>交叉驗證</span></li>
</ul><table>
<thead>
<tr>
<th><span>ACC</span></th>
<th><span>train_ACC</span></th>
<th><span>validation_ACC</span></th>
<th><span>recall</span></th>
<th><span>train_recall</span></th>
<th><span>validation_recall</span></th>
<th><span>percion</span></th>
<th><span>training_p</span></th>
<th><span>validation_p</span></th>
<th><span>AUC</span></th>
<th><span>train_AUC</span></th>
<th><span>validation_AUC</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>fold1</span></td>
<td><span>0.55</span></td>
<td><span>0.54</span></td>
<td><span>fold1</span></td>
<td><span>1</span></td>
<td><span>1</span></td>
<td><span>fold1</span></td>
<td><span>0.55</span></td>
<td><span>0.54</span></td>
<td><span>fold1</span></td>
<td><span>0.69</span></td>
<td><span>0.68</span></td>
</tr>
<tr>
<td><span>fold2</span></td>
<td><span>0.55</span></td>
<td><span>0.54</span></td>
<td><span>fold2</span></td>
<td><span>1</span></td>
<td><span>0.99</span></td>
<td><span>fold2</span></td>
<td><span>0.55</span></td>
<td><span>0.54</span></td>
<td><span>fold2</span></td>
<td><span>0.7</span></td>
<td><span>0.65</span></td>
</tr>
<tr>
<td><span>fold3</span></td>
<td><span>0.54</span></td>
<td><span>0.57</span></td>
<td><span>fold3</span></td>
<td><span>1</span></td>
<td><span>1</span></td>
<td><span>fold3</span></td>
<td><span>0.54</span></td>
<td><span>0.57</span></td>
<td><span>fold3</span></td>
<td><span>0.68</span></td>
<td><span>0.72</span></td>
</tr>
<tr>
<td><span>fold4</span></td>
<td><span>0.56</span></td>
<td><span>0.51</span></td>
<td><span>fold4</span></td>
<td><span>1</span></td>
<td><span>1</span></td>
<td><span>fold4</span></td>
<td><span>0.56</span></td>
<td><span>0.51</span></td>
<td><span>fold4</span></td>
<td><span>0.69</span></td>
<td><span>0.68</span></td>
</tr>
<tr>
<td><span>fold5</span></td>
<td><span>0.54</span></td>
<td><span>0.57</span></td>
<td><span>fold5</span></td>
<td><span>1</span></td>
<td><span>0.99</span></td>
<td><span>fold5</span></td>
<td><span>0.54</span></td>
<td><span>0.57</span></td>
<td><span>fold5</span></td>
<td><span>0.7</span></td>
<td><span>0.66</span></td>
</tr>
<tr>
<td><span>ave.</span></td>
<td><span>0.55</span></td>
<td><span>0.55</span></td>
<td><span>ave.</span></td>
<td><span>1</span></td>
<td><span>1</span></td>
<td><span>ave.</span></td>
<td><span>0.55</span></td>
<td><span>0.55</span></td>
<td><span>ave.</span></td>
<td><span>0.69</span></td>
<td><span>0.68</span></td>
</tr>
</tbody>
</table><ul>
<li><span>最終在train 、test上之表現</span></li>
</ul><table>
<thead>
<tr>
<th><span>Mectrics</span></th>
<th><span>train</span></th>
<th><span>test</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>ACC</span></td>
<td><span>0.549259</span></td>
<td><span>0.5</span></td>
</tr>
<tr>
<td><span>Percision</span></td>
<td><span>0.991794</span></td>
<td><span>0.5</span></td>
</tr>
<tr>
<td><span>Recall</span></td>
<td><span>1</span></td>
<td><span>1</span></td>
</tr>
<tr>
<td><span>AUC</span></td>
<td><span>0.687559</span></td>
<td><span>0.5764</span></td>
</tr>
<tr>
<td><span>ROC Curve</span></td>
<td><img src="https://i.imgur.com/ABzeyA4.jpg" alt="" loading="lazy"></td>
<td><img src="https://i.imgur.com/BNsEStl.jpg" alt="" loading="lazy"></td>
</tr>
</tbody>
</table><blockquote>
<p><span>整體而言，只有linear SVM 搭配漲跌幅可以提升模型預測之的表現結果。其餘實驗和null model表現較將近。</span></p>
</blockquote><h3 id="CNN-amp-TCN" data-id="CNN-amp-TCN"><a class="anchor hidden-xs" href="#CNN-amp-TCN" title="CNN-amp-TCN"><span class="octicon octicon-link"></span></a><strong><span>CNN &amp; TCN</span></strong></h3><h4 id="Import" data-id="Import"><a class="anchor hidden-xs" href="#Import" title="Import"><span class="octicon octicon-link"></span></a><strong><span>Import</span></strong></h4><pre><code class="r hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span>
<span></span></div><div class="code">library<span class="token punctuation">(</span>keras<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>tensorflow<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>caret<span class="token punctuation">)</span> 
library<span class="token punctuation">(</span>pROC<span class="token punctuation">)</span>
</div></div></code></pre><h4 id="Data-pre-processing3" data-id="Data-pre-processing"><a class="anchor hidden-xs" href="#Data-pre-processing3" title="Data-pre-processing3"><span class="octicon octicon-link"></span></a><strong><span>Data pre-processing</span></strong></h4><div class="alert alert-info">
<p><span>有正負的用標準化，數值較大的用Min Max做處理</span></p>
</div><pre><code class="r hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span></div><div class="code"><span class="token comment">#Drop date column</span>
df <span class="token operator">&lt;-</span> df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">8</span><span class="token punctuation">]</span>

<span class="token comment"># min-max scale</span>
df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">-</span>min<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>max<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-</span>min<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">-</span>min<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>max<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-</span>min<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">-</span>min<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>max<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-</span>min<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">-</span>min<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>max<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-</span>min<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># z-scale</span>
df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">-</span> mean<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> sd<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">-</span> mean<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> sd<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</div></div></code></pre><h4 id="Data-Reshape" data-id="Data-Reshape"><a class="anchor hidden-xs" href="#Data-Reshape" title="Data-Reshape"><span class="octicon octicon-link"></span></a><strong><span>Data Reshape</span></strong></h4><pre><code class="r hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span></div><div class="code"><span class="token comment">######################### Train </span>
x <span class="token operator">&lt;-</span> rbind<span class="token punctuation">(</span>train_set_X<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1541</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> train_set_X<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">1542</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> train_set_X<span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">1543</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> train_set_X<span class="token punctuation">[</span><span class="token number">4</span><span class="token operator">:</span><span class="token number">1544</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> train_set_X<span class="token punctuation">[</span><span class="token number">5</span><span class="token operator">:</span><span class="token number">1545</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> train_set_X<span class="token punctuation">[</span><span class="token number">6</span><span class="token operator">:</span><span class="token number">1546</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> train_set_X<span class="token punctuation">[</span><span class="token number">7</span><span class="token operator">:</span><span class="token number">1547</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> train_set_X<span class="token punctuation">[</span><span class="token number">8</span><span class="token operator">:</span><span class="token number">1548</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> train_set_X<span class="token punctuation">[</span><span class="token number">9</span><span class="token operator">:</span><span class="token number">1549</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> train_set_X<span class="token punctuation">[</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">1550</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> train_set_X<span class="token punctuation">[</span><span class="token number">11</span><span class="token operator">:</span><span class="token number">1551</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> train_set_X<span class="token punctuation">[</span><span class="token number">12</span><span class="token operator">:</span><span class="token number">1552</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
train_array_x <span class="token operator">&lt;-</span> array<span class="token punctuation">(</span>x<span class="token punctuation">,</span>dim<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">1541</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># train_y</span>
trainy <span class="token operator">&lt;-</span> data.matrix<span class="token punctuation">(</span>train_set_Y<span class="token punctuation">,</span> rownames.force <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">)</span>
train_array_y <span class="token operator">&lt;-</span> array<span class="token punctuation">(</span>trainy<span class="token punctuation">[</span><span class="token number">12</span><span class="token operator">:</span><span class="token number">1552</span><span class="token punctuation">]</span><span class="token punctuation">,</span>dim<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">1541</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token comment">################## Test</span>
<span class="token comment"># Test_x</span>
test_array_X <span class="token operator">&lt;-</span> array<span class="token punctuation">(</span>test_set_X<span class="token punctuation">[</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">89</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">:</span><span class="token number">91</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token operator">:</span><span class="token number">92</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token operator">:</span><span class="token number">93</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token operator">:</span><span class="token number">94</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token operator">:</span><span class="token number">95</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token operator">:</span><span class="token number">96</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token operator">:</span><span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">98</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">99</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">89</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
print<span class="token punctuation">(</span>dim<span class="token punctuation">(</span>test_array_X<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># Test_y</span>
testy <span class="token operator">&lt;-</span> data.matrix<span class="token punctuation">(</span>test_set_Y<span class="token punctuation">,</span> rownames.force <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">)</span>
test_array_y <span class="token operator">&lt;-</span> array<span class="token punctuation">(</span>testy<span class="token punctuation">[</span><span class="token number">12</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span>dim<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">89</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</div></div></code></pre><h4 id="Build-CNN-and-TCN-Model" data-id="Build-CNN-and-TCN-Model"><a class="anchor hidden-xs" href="#Build-CNN-and-TCN-Model" title="Build-CNN-and-TCN-Model"><span class="octicon octicon-link"></span></a><strong><span>Build CNN and TCN Model</span></strong></h4><h4 id="TCN" data-id="TCN"><a class="anchor hidden-xs" href="#TCN" title="TCN"><span class="octicon octicon-link"></span></a><strong><span>TCN</span></strong></h4><pre><code class="r hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span></div><div class="code">model <span class="token operator">&lt;-</span> keras_model_sequential<span class="token punctuation">(</span><span class="token punctuation">)</span> 

<span class="token comment"># TCN</span>
model <span class="token percent-operator operator">%&gt;%</span> 
  layer_conv_1d<span class="token punctuation">(</span>filters <span class="token operator">=</span> <span class="token number">32</span><span class="token punctuation">,</span> kernel_size <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> activation <span class="token operator">=</span> <span class="token string">"relu"</span><span class="token punctuation">,</span> 
                input_shape <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> 
  layer_conv_1d<span class="token punctuation">(</span>filters <span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">,</span> kernel_size <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> dilation_rate<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> activation <span class="token operator">=</span> <span class="token string">"relu"</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> 
  layer_conv_1d<span class="token punctuation">(</span>filters <span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">,</span> kernel_size <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> dilation_rate<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> activation <span class="token operator">=</span> <span class="token string">"relu"</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> 
  layer_flatten<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> 
  layer_dense<span class="token punctuation">(</span>units <span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">,</span> activation <span class="token operator">=</span> <span class="token string">"relu"</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> 
  layer_dense<span class="token punctuation">(</span>units <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> activation <span class="token operator">=</span> <span class="token string">"sigmoid"</span><span class="token punctuation">)</span>

summary<span class="token punctuation">(</span>model<span class="token punctuation">)</span>
</div></div></code></pre><p><img src="https://i.imgur.com/RvbXefH.png" alt="" loading="lazy"></p><h4 id="CNN" data-id="CNN"><a class="anchor hidden-xs" href="#CNN" title="CNN"><span class="octicon octicon-link"></span></a><strong><span>CNN</span></strong></h4><pre><code class="r hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span></div><div class="code"><span class="token comment">#CNN</span>
model <span class="token operator">&lt;-</span> keras_model_sequential<span class="token punctuation">(</span><span class="token punctuation">)</span> 

model <span class="token percent-operator operator">%&gt;%</span> 
  layer_conv_1d<span class="token punctuation">(</span>filters <span class="token operator">=</span> <span class="token number">32</span><span class="token punctuation">,</span> kernel_size <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> activation <span class="token operator">=</span> <span class="token string">"relu"</span><span class="token punctuation">,</span> 
                input_shape <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> 
  layer_conv_1d<span class="token punctuation">(</span>filters <span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">,</span> kernel_size <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> activation <span class="token operator">=</span> <span class="token string">"relu"</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> 
  layer_conv_1d<span class="token punctuation">(</span>filters <span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">,</span> kernel_size <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> activation <span class="token operator">=</span> <span class="token string">"relu"</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> 
  layer_flatten<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> 
  layer_dense<span class="token punctuation">(</span>units <span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">,</span> activation <span class="token operator">=</span> <span class="token string">"relu"</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> 
  layer_dense<span class="token punctuation">(</span>units <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> activation <span class="token operator">=</span> <span class="token string">"sigmoid"</span><span class="token punctuation">)</span>

summary<span class="token punctuation">(</span>model<span class="token punctuation">)</span>
</div></div></code></pre><p><img src="https://i.imgur.com/JqtSFET.png" alt="" loading="lazy"></p><hr><h4 id="Train-Model" data-id="Train-Model"><a class="anchor hidden-xs" href="#Train-Model" title="Train-Model"><span class="octicon octicon-link"></span></a><strong><span>Train Model</span></strong></h4><div class="alert alert-info">
<p><span style="color:red"><strong><span>Hyperparameters</span></strong></span><br>
<strong><span>Optimizer</span></strong><span> : Adam</span><br>
<strong><span>Loss</span></strong><span> : binary_crossentropy</span><br>
<strong><span>metrics</span></strong><span> = accuracy</span><br>
<strong><span>epochs</span></strong><span>= 50</span></p>
</div><pre><code class="r hljs"><div class="wrapper"><div class="gutter linenumber"><span></span></div><div class="code">history <span class="token operator">&lt;-</span> model <span class="token percent-operator operator">%&gt;%</span> fit<span class="token punctuation">(</span>train_array_x<span class="token punctuation">,</span> train_array_y<span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">,</span> verbose<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> validation_split <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">)</span>
</div></div></code></pre><h4 id="Predict" data-id="Predict"><a class="anchor hidden-xs" href="#Predict" title="Predict"><span class="octicon octicon-link"></span></a><strong><span>Predict</span></strong></h4><pre><code class="r hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span>
<span></span>
<span></span></div><div class="code">predict_y <span class="token operator">&lt;-</span> model <span class="token percent-operator operator">%&gt;%</span> predict<span class="token punctuation">(</span>test_array_X<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
predict_y <span class="token operator">&lt;-</span> round<span class="token punctuation">(</span>predict_y<span class="token punctuation">)</span>

print<span class="token punctuation">(</span>predict_y<span class="token punctuation">)</span>
<span class="token comment">#print(predict_y)</span>
</div></div></code></pre><h4 id="Performance" data-id="Performance"><a class="anchor hidden-xs" href="#Performance" title="Performance"><span class="octicon octicon-link"></span></a><strong><span>Performance</span></strong></h4><pre><code class="r hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span></div><div class="code">plot<span class="token punctuation">(</span>history<span class="token punctuation">)</span>
print<span class="token punctuation">(</span>history<span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>roc<span class="token punctuation">(</span>test_array_y<span class="token punctuation">,</span>predict_y<span class="token punctuation">)</span><span class="token punctuation">,</span> print.auc<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>
</div></div></code></pre><h4 id="TCN1" data-id="TCN"><a class="anchor hidden-xs" href="#TCN1" title="TCN1"><span class="octicon octicon-link"></span></a><strong><span>TCN</span></strong></h4><p><img src="https://i.imgur.com/71HTxW6.png" alt="" loading="lazy"></p><p><img src="https://i.imgur.com/fVjwHUK.png" alt="" loading="lazy"></p><p><img src="https://i.imgur.com/bI7xbQ9.png" alt="" loading="lazy"></p><h4 id="CNN1" data-id="CNN"><a class="anchor hidden-xs" href="#CNN1" title="CNN1"><span class="octicon octicon-link"></span></a><strong><span>CNN</span></strong></h4><p><img src="https://i.imgur.com/TDqmDfQ.png" alt="" loading="lazy"></p><p><img src="https://i.imgur.com/QmR6tuN.png" alt="" loading="lazy"></p><p><img src="https://i.imgur.com/cgLtArS.png" alt="" loading="lazy"></p><h3 id="LSTM" data-id="LSTM"><a class="anchor hidden-xs" href="#LSTM" title="LSTM"><span class="octicon octicon-link"></span></a><strong><span>LSTM</span></strong></h3><div class="alert alert-info">
<p><span>資料前處理與LSTM一樣差別在Reshape</span></p>
</div><h4 id="Import1" data-id="Import"><a class="anchor hidden-xs" href="#Import1" title="Import1"><span class="octicon octicon-link"></span></a><strong><span>Import</span></strong></h4><pre><code class="r hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span>
<span></span></div><div class="code">library<span class="token punctuation">(</span>keras<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>tensorflow<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>caret<span class="token punctuation">)</span> 
library<span class="token punctuation">(</span>pROC<span class="token punctuation">)</span>
</div></div></code></pre><h4 id="Split-train-and-test-data" data-id="Split-train-and-test-data"><a class="anchor hidden-xs" href="#Split-train-and-test-data" title="Split-train-and-test-data"><span class="octicon octicon-link"></span></a><strong><span>Split train and test data</span></strong></h4><div class="alert alert-info">
<p><span>Train 80% Test 20% 因為是RNN因此不能用上面隨機切順序會影響</span></p>
</div><pre><code class="r hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span></div><div class="code">testing_set <span class="token operator">&lt;-</span> df<span class="token punctuation">[</span><span class="token punctuation">(</span>nrow<span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token operator">:</span>nrow<span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">]</span>

df <span class="token operator">&lt;-</span> df<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1553</span><span class="token punctuation">,</span><span class="token punctuation">]</span> <span class="token comment">#1553</span>

<span class="token comment"># trian 1553  #test 100</span>
train_set_X <span class="token operator">&lt;-</span> df<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1553</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token comment"># 1553 * 6</span>
train_set_Y <span class="token operator">&lt;-</span> df<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1553</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span>  <span class="token comment"># 1553* 1</span>

test_set_X <span class="token operator">&lt;-</span> testing_set<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token comment"># 100 * 6</span>
test_set_Y <span class="token operator">&lt;-</span> testing_set<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span> <span class="token comment"># 100 * 1</span>


train_set_X <span class="token operator">&lt;-</span> data.matrix<span class="token punctuation">(</span>train_set_X<span class="token punctuation">,</span> rownames.force <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">)</span>
test_set_X <span class="token operator">&lt;-</span> data.matrix<span class="token punctuation">(</span>test_set_X<span class="token punctuation">,</span> rownames.force <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">)</span>
</div></div></code></pre><h4 id="Convert-data-type-and-reshape" data-id="Convert-data-type-and-reshape"><a class="anchor hidden-xs" href="#Convert-data-type-and-reshape" title="Convert-data-type-and-reshape"><span class="octicon octicon-link"></span></a><strong><span>Convert data type and reshape</span></strong></h4><pre><code class="r hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span></div><div class="code">
<span class="token comment">####################Train</span>
x <span class="token operator">&lt;-</span> rbind<span class="token punctuation">(</span>train_set_X<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1549</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> train_set_X<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">1550</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> train_set_X<span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">1551</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> train_set_X<span class="token punctuation">[</span><span class="token number">4</span><span class="token operator">:</span><span class="token number">1552</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
train_array_x <span class="token operator">&lt;-</span> array<span class="token punctuation">(</span>x<span class="token punctuation">,</span>dim<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">1549</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># train_y</span>
trainy <span class="token operator">&lt;-</span> data.matrix<span class="token punctuation">(</span>train_set_Y<span class="token punctuation">,</span> rownames.force <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">)</span>
train_array_y <span class="token operator">&lt;-</span> array<span class="token punctuation">(</span>trainy<span class="token punctuation">[</span><span class="token number">4</span><span class="token operator">:</span><span class="token number">1552</span><span class="token punctuation">]</span><span class="token punctuation">,</span>dim<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">1549</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
print<span class="token punctuation">(</span>dim<span class="token punctuation">(</span>train_array_y<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">####################Test</span>
<span class="token comment"># Test_x</span>
test_array_X <span class="token operator">&lt;-</span> array<span class="token punctuation">(</span>test_set_X<span class="token punctuation">[</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">98</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">:</span><span class="token number">99</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
print<span class="token punctuation">(</span>dim<span class="token punctuation">(</span>test_array_X<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># Test_y</span>
testy <span class="token operator">&lt;-</span> data.matrix<span class="token punctuation">(</span>test_set_Y<span class="token punctuation">,</span> rownames.force <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">)</span>
test_array_y <span class="token operator">&lt;-</span> array<span class="token punctuation">(</span>testy<span class="token punctuation">[</span><span class="token number">4</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span>dim<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
print<span class="token punctuation">(</span>dim<span class="token punctuation">(</span>test_array_y<span class="token punctuation">)</span><span class="token punctuation">)</span>
</div></div></code></pre><h4 id="Build-LSTM-Model" data-id="Build-LSTM-Model"><a class="anchor hidden-xs" href="#Build-LSTM-Model" title="Build-LSTM-Model"><span class="octicon octicon-link"></span></a><strong><span>Build LSTM Model</span></strong></h4><pre><code class="r hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span></div><div class="code">model <span class="token operator">&lt;-</span> keras_model_sequential<span class="token punctuation">(</span><span class="token punctuation">)</span>
model <span class="token percent-operator operator">%&gt;%</span> 
  layer_lstm<span class="token punctuation">(</span>units <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> return_sequences <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> stateful <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
             batch_input_shape <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> 
  layer_lstm<span class="token punctuation">(</span>units <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">,</span> return_sequences <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> stateful <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span>
  layer_dropout<span class="token punctuation">(</span>rate <span class="token operator">=</span> <span class="token number">0.3</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span>
  layer_lstm<span class="token punctuation">(</span>units <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">,</span> return_sequences <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>stateful <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span>
    layer_dropout<span class="token punctuation">(</span>rate <span class="token operator">=</span> <span class="token number">0.3</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span>
  layer_lstm<span class="token punctuation">(</span>units <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">,</span> stateful <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> 
  layer_dense<span class="token punctuation">(</span>units <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> activation <span class="token operator">=</span> <span class="token string">'sigmoid'</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> 
  compile<span class="token punctuation">(</span>
    loss <span class="token operator">=</span> <span class="token string">'binary_crossentropy'</span><span class="token punctuation">,</span>
    optimizer <span class="token operator">=</span> optimizer_adam<span class="token punctuation">(</span>learning_rate<span class="token operator">=</span> <span class="token number">0.01</span> <span class="token punctuation">,</span> decay <span class="token operator">=</span> <span class="token number">1e-6</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
    metrics <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">'accuracy'</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
<span class="token operator">!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>i.imgur.com<span class="token operator">/</span>lrj93Ba.png<span class="token punctuation">)</span>

summary<span class="token punctuation">(</span>model<span class="token punctuation">)</span>
</div></div></code></pre><p><img src="https://i.imgur.com/126xICC.png" alt="" loading="lazy"></p><hr><h4 id="Train-Model1" data-id="Train-Model"><a class="anchor hidden-xs" href="#Train-Model1" title="Train-Model1"><span class="octicon octicon-link"></span></a><strong><span>Train Model</span></strong></h4><div class="alert alert-info">
<p><span style="color:red"><strong><span>Hyperparameters</span></strong></span><br>
<strong><span>Optimizer</span></strong><span> : Adam</span><br>
<strong><span>Loss</span></strong><span> : binary_crossentropy</span><br>
<strong><span>metrics</span></strong><span> = accuracy</span><br>
<strong><span>epochs</span></strong><span>=50</span></p>
</div><pre><code class="r hljs"><div class="wrapper"><div class="gutter linenumber"><span></span></div><div class="code"> history <span class="token operator">&lt;-</span> model <span class="token percent-operator operator">%&gt;%</span> fit<span class="token punctuation">(</span>train_array_x<span class="token punctuation">,</span> train_array_y<span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">,</span> verbose<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> validation_split <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">)</span>
</div></div></code></pre><h4 id="Predict1" data-id="Predict"><a class="anchor hidden-xs" href="#Predict1" title="Predict1"><span class="octicon octicon-link"></span></a><strong><span>Predict</span></strong></h4><pre><code class="r hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span>
<span></span>
<span></span></div><div class="code">predict_y <span class="token operator">&lt;-</span> model <span class="token percent-operator operator">%&gt;%</span> predict<span class="token punctuation">(</span>test_array_X<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

predict_y <span class="token operator">&lt;-</span> round<span class="token punctuation">(</span>predict_y<span class="token punctuation">)</span>
table<span class="token punctuation">(</span>predict_y<span class="token punctuation">,</span> test_array_y<span class="token punctuation">)</span>
<span class="token comment">#print(predict_y)</span>
</div></div></code></pre><h4 id="Performance1" data-id="Performance"><a class="anchor hidden-xs" href="#Performance1" title="Performance1"><span class="octicon octicon-link"></span></a><strong><span>Performance</span></strong></h4><pre><code class="r hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span></div><div class="code">plot<span class="token punctuation">(</span>history<span class="token punctuation">)</span>
print<span class="token punctuation">(</span>history<span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>roc<span class="token punctuation">(</span>test_array_y<span class="token punctuation">,</span>predict_y<span class="token punctuation">)</span><span class="token punctuation">,</span> print.auc<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>
</div></div></code></pre><p><img src="https://i.imgur.com/7k11XZW.png" alt="" loading="lazy"></p><p><img src="https://i.imgur.com/PY9T1vG.png" alt="" loading="lazy"></p><p><img src="https://i.imgur.com/jlQjKlN.png" alt="" loading="lazy"></p><h2 id="References" data-id="References"><a class="anchor hidden-xs" href="#References" title="References"><span class="octicon octicon-link"></span></a><strong><span>References</span></strong></h2><ul>
<li><span>Code/implementation which you include/reference (</span><strong><span>You should indicate in your presentation if you use code for others. Otherwise, cheating will result in 0 score for final project.</span></strong><span>)</span>
<ul>
<li><a href="https://finmind.github.io/tutor/TaiwanMarket/DataList/" target="_blank" rel="noopener"><span>Finmind api for total net of TSMC</span></a></li>
<li><a href="https://hk.finance.yahoo.com/" target="_blank" rel="noopener"><span>雅虎財經 for 美股四大指數</span></a></li>
<li><a href="https://hk.investing.com/crypto/" target="_blank" rel="noopener"><span>比特幣</span></a></li>
<li><a href="https://www.taiwanindex.com.tw/" target="_blank" rel="noopener"><span>台灣指數公司 for TAIEX</span></a></li>
<li><a href="https://tensorflow.rstudio.com/" target="_blank" rel="noopener"><span>R tensorflow</span></a></li>
<li><a href="https://www.rdocumentation.org/" target="_blank" rel="noopener"><span>R Docs</span></a></li>
</ul>
</li>
</ul><h3 id="Packages-you-use" data-id="Packages-you-use"><a class="anchor hidden-xs" href="#Packages-you-use" title="Packages-you-use"><span class="octicon octicon-link"></span></a><span>Packages you use</span></h3><pre><code class="r hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span></div><div class="code">library<span class="token punctuation">(</span>tensorflow<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>ggplot2<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>keras<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>caret<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>pROC<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>ROCR<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>rpart<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>randomForest<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>e1071<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>lattice<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>gridExtra<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>shiny<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>DT<span class="token punctuation">)</span>
library<span class="token punctuation">(</span><span class="token string">"corrplot"</span><span class="token punctuation">)</span>
library<span class="token punctuation">(</span>reactable
</div></div></code></pre><h3 id="Related-publications" data-id="Related-publications"><a class="anchor hidden-xs" href="#Related-publications" title="Related-publications"><span class="octicon octicon-link"></span></a><span>Related publications</span></h3><p><span>Tsmc.api.R (in code dictionary), this api was download from (</span><a href="https://finmind.github.io/" target="_blank" rel="noopener"><span>https://finmind.github.io/</span></a><span>), which is an open source, more details will show in final paper.</span></p></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li><a href="#Group1-以股為鏡–台股上漲預測" title="Group1. 以股為鏡–台股上漲預測">Group1. 以股為鏡–台股上漲預測</a><ul class="nav">
<li class="invisable-node"><ul class="nav">
<li><a href="#Menbers" title="Menbers">Menbers</a></li>
<li><a href="#Our-Goal" title="Our Goal">Our Goal</a></li>
<li><a href="#Demo" title="Demo">Demo</a></li>
</ul>
</li>
<li><a href="#Folder-organization-and-its-related-information" title="Folder organization and its related information">Folder organization and its related information</a><ul class="nav">
<li><a href="#docs" title="docs">docs</a></li>
<li><a href="#data" title="data">data</a></li>
<li><a href="#code" title="code">code</a></li>
<li><a href="#results" title="results">results</a></li>
<li><a href="#Future-Work" title="Future Work">Future Work</a></li>
</ul>
</li>
<li><a href="#Model" title="Model">Model</a><ul class="nav">
<li><a href="#Logistic-Regression" title="Logistic Regression">Logistic Regression</a></li>
<li><a href="#QDA" title="QDA">QDA</a></li>
<li><a href="#NaiveBayes" title="NaiveBayes">NaiveBayes</a></li>
<li><a href="#Decision-Tree" title="Decision Tree">Decision Tree</a></li>
<li><a href="#Random-Forest" title="Random Forest">Random Forest</a></li>
<li><a href="#SVM" title="SVM">SVM</a></li>
<li><a href="#CNN-amp-TCN" title="CNN &amp; TCN">CNN &amp; TCN</a></li>
<li><a href="#LSTM" title="LSTM">LSTM</a></li>
</ul>
</li>
<li><a href="#References" title="References">References</a><ul class="nav">
<li><a href="#Packages-you-use" title="Packages you use">Packages you use</a></li>
<li><a href="#Related-publications" title="Related publications">Related publications</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">全部展開</a><a class="back-to-top" href="#">回到頂部</a><a class="go-to-bottom" href="#">移至底部</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;" null null>
        <div class="toc"><ul class="nav">
<li class=""><a href="#Group1-以股為鏡–台股上漲預測" title="Group1. 以股為鏡–台股上漲預測">Group1. 以股為鏡–台股上漲預測</a><ul class="nav">
<li class="invisable-node"><ul class="nav">
<li class=""><a href="#Menbers" title="Menbers">Menbers</a></li>
<li class=""><a href="#Our-Goal" title="Our Goal">Our Goal</a></li>
<li class=""><a href="#Demo" title="Demo">Demo</a></li>
</ul>
</li>
<li class=""><a href="#Folder-organization-and-its-related-information" title="Folder organization and its related information">Folder organization and its related information</a><ul class="nav">
<li class=""><a href="#docs" title="docs">docs</a></li>
<li class=""><a href="#data" title="data">data</a></li>
<li class=""><a href="#code" title="code">code</a></li>
<li class=""><a href="#results" title="results">results</a></li>
<li class=""><a href="#Future-Work" title="Future Work">Future Work</a></li>
</ul>
</li>
<li class=""><a href="#Model" title="Model">Model</a><ul class="nav">
<li class=""><a href="#Logistic-Regression" title="Logistic Regression">Logistic Regression</a></li>
<li class=""><a href="#QDA" title="QDA">QDA</a></li>
<li><a href="#NaiveBayes" title="NaiveBayes">NaiveBayes</a></li>
<li class=""><a href="#Decision-Tree" title="Decision Tree">Decision Tree</a></li>
<li class=""><a href="#Random-Forest" title="Random Forest">Random Forest</a></li>
<li><a href="#SVM" title="SVM">SVM</a></li>
<li><a href="#CNN-amp-TCN" title="CNN &amp; TCN">CNN &amp; TCN</a></li>
<li><a href="#LSTM" title="LSTM">LSTM</a></li>
</ul>
</li>
<li><a href="#References" title="References">References</a><ul class="nav">
<li><a href="#Packages-you-use" title="Packages you use">Packages you use</a></li>
<li><a href="#Related-publications" title="Related publications">Related publications</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">全部展開</a><a class="back-to-top" href="#">回到頂部</a><a class="go-to-bottom" href="#">移至底部</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
